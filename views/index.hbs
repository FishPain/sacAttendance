<script defer src="/vendor/makerspace/app.js"></script>

<form method="POST" onsubmit="showLoadingModal()">

    <section class="section">
        <div class="container">
            <div class="box p-6">
                <div class="columns is-vcentered">
                    <div class="column">
                        <h1 class="title is-1" id="time-display"></h1>
                        <p class="subtitle is-4" id="good-day"></p>
                    </div>
                    <div class="column">
                        <div>
                            <h2 class="title is-4">Shift Work</h2>
                            <p class="subtitle">For scheduled jobs on roster.</p>
                            <a class="button is-info openCardModalBtn">
                                <span class="icon">
                                    <i class="fas fa-arrow-right"></i>
                                </span>
                                <span>Continue</span>
                            </a>
                        </div>
                        <hr>
                        <div>
                            <h2 class="title is-4">Non-shift Work</h2>
                            <p class="subtitle">For project work, etc.</p>
                            <div class="field">
                                <div class="control has-icons-left">
                                    <div class="select">
                                        <select id="remarkField" name="remarkField">
                                            <option value="null" selected disabled>Choose remark</option>
                                            {{#each remarks}}
                                            <option value="{{this}}">{{this}}</option>
                                            {{/each}}
                                            <option value="others%">Others</option>
                                        </select>
                                    </div>
                                    <div class="icon is-small is-left">
                                        <i class="fas fa-clipboard-list"></i>
                                    </div>
                                </div>
                            </div>
                            <div id="otherFieldsContainer" class="field" style="display: none;">
                                <p class="control">
                                    <input class="input" type="text" id="otherFields" name="otherFields"
                                        placeholder="Write your remark...">
                                </p>
                            </div>
                            <a class="button is-info openCardModalBtn">
                                <span class="icon">
                                    <i class="fas fa-arrow-right"></i>
                                </span>
                                <span>Continue</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="scanCardModal" class="modal is-active" style="display: none">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box p-6">
                <div class="has-text-centered">
                    <div class="is-size-1">
                        <div class="id-card-icon"><i class="fas fa-id-card"></i></div>
                        <div class="id-card-icon-shadow"></div>
                    </div>
                    <p class="title mt-4">Tap card</p>
                    <p class="subtitle">Move your card towards the reader</p>
                </div>
            </div>
        </div>
        <input type="text" style="z-index: -9999999; opacity: 0; position: absolute; height: 0px" placeholder="Card ID"
            autocomplete="off" id="input-cardID" name="cardID" required>
        <input type="submit" style="z-index: -9999999; opacity: 0; position: absolute; height: 0px" />
        {{!-- style="z-index: -9999999; opacity: 0; position: absolute; height: 0px" --}}
        <a class="modal-close is-large" aria-label="close" onclick="$('#scanCardModal').fadeOut('fast')"></a>
    </div>

    <div id="loadingModal" class="modal is-active" style="display: none">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box p-6">
                <div class="is-size-1 has-text-centered">
                    <i class="fas fa-spinner fa-pulse"></i>
                    <p class="title mt-4">Loading</p>
                    <p class="subtitle">Processing check-in</p>
                </div>
            </div>
        </div>
    </div>


    {{#if statusSuccessIn}}
    <script>
        var audio = new Audio('/static/audio/OK.mp3');
        audio.play();
    </script>
    <div id="scanCardOKInModal" class="modal is-active">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box p-6">
                <div class="is-size-1 has-text-centered">
                    <div class="has-text-success-dark"><i class="fas fa-check-circle"></i></div>
                    <div class="id-card-icon-shadow"></div>
                    <p class="title mt-4">Checked-in</p>
                    <p class="subtitle">Logged at {{ timeLogged }}</p>
                </div>
            </div>
        </div>
        <a class="modal-close is-large" aria-label="close" onclick="$('#scanCardOKInModal').fadeOut('fast')"></a>
    </div>
    {{/if}}

    {{#if statusSuccessOut}}
    <script>
        var audio = new Audio('/static/audio/OK.mp3');
        audio.play();
    </script>
    <div id="scanCardOKOutModal" class="modal is-active">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box p-6">
                <div class="is-size-1 has-text-centered">
                    <div class="text-success"><i class="fas fa-sign-out-alt"></i></div>
                    <div class="id-card-icon-shadow"></div>
                    <p class="title mt-4">Checked-out</p>
                    <p class="subtitle">Logged at {{ timeLogged }}</p>
                </div>
            </div>
        </div>
        <a class="modal-close is-large" aria-label="close" onclick="$('#scanCardOKInModal').fadeOut('fast')"></a>
    </div>
    {{/if}}

    {{#if statusFail}}
    <script>
        var audio = new Audio('/static/audio/Failed.mp3');
        audio.play();
    </script>
    <div id="scanCardAlreadyOutModal" class="modal is-active">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box p-6">
                <div class="is-size-1 has-text-centered">
                    <div class="id-card-failed-icon has-text-danger-dark"><i class="fas fa-times"></i></div>
                    <div class="id-card-icon-shadow"></div>
                    <p class="title mt-4 has-text-danger-dark">Card Error</p>
                    <p class="subtitle">Please ensure that you are using the correct card<br><small
                            class="has-text-grey-light">If you believe that this is an error, please seek for
                            assistance</small></p>
                </div>
            </div>
        </div>
        <a class="modal-close is-large" aria-label="close" onclick="$('#scanCardAlreadyOutModal').fadeOut('fast')"></a>
    </div>
    {{/if}}

    {{#if statusFailAlreadyOut}}
    <script>
        var audio = new Audio('/static/audio/Failed.mp3');
        audio.play();
    </script>
    <div id="scanCardFailedModal" class="modal is-active">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box p-6">
                <div class="is-size-1 has-text-centered">
                    <div class="id-card-tick-icon"><i class="fas fa-id-card"></i></div>
                    <div class="id-card-icon-shadow"></div>
                    <p class="title mt-4 has-text-danger-dark">Duplicate Check-out</p>
                    <p class="subtitle">Last tap was registered at {{ error.timeDone }}</p>
                </div>
            </div>
        </div>
        <a class="modal-close is-large" aria-label="close" onclick="$('#scanCardFailedModal').fadeOut('fast')"></a>
    </div>
    {{/if}}

    {{#if statusFailAlreadyIn}}
    <script>
        var audio = new Audio('/static/audio/Failed.mp3');
        audio.play();
    </script>
    <div id="scanCardAlreadyInModal" class="modal is-active">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box p-6">
                <div class="is-size-1 has-text-centered">
                    <div><i class="fas fa-business-time"></i></div>
                    <p class="title mt-4 has-text-danger-dark">Duplicate Check-in</p>
                    <p class="subtitle">Last tap was registered at {{ error.timeDone }}</p>
                </div>
            </div>
        </div>
        <a class="modal-close is-large" aria-label="close" onclick="$('#scanCardAlreadyInModal').fadeOut('fast')"></a>
    </div>
    {{/if}}

</form>